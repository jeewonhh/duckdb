# name: test/optimizer/limit_pushdown.test
# description: Test Limit pushdown
# group: [optimizer]

statement ok
CREATE TABLE integers(i INTEGER, j INTEGER)

statement ok
PRAGMA explain_output = OPTIMIZED_ONLY;


# standalone projection
query II
EXPLAIN SELECT i FROM integers
----
logical_opt	<REGEX>:.*PROJECTION.*

# projection + limit transformed into limit + projection
query II
EXPLAIN SELECT i FROM integers LIMIT 4;
----
logical_opt <REGEX>:.*PROJECTION.*LIMIT.*

# also works with offset
query II
EXPLAIN SELECT i FROM integers LIMIT 4 OFFSET 3
----
logical_opt <REGEX>:.*PROJECTION.*LIMIT.*

